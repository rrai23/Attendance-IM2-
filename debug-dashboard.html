<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Debug Test</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div style="padding: 20px;">
        <h1>Dashboard Debug Test</h1>
        <div id="status">Loading...</div>
        <div id="results" style="margin-top: 20px; font-family: monospace; white-space: pre-wrap;"></div>
        <div id="errors" style="margin-top: 20px; color: red; font-family: monospace;"></div>
    </div>

    <!-- Load JavaScript files -->
    <script>
        let results = '';
        
        function log(message) {
            results += message + '\n';
            document.getElementById('results').textContent = results;
            console.log(message);
        }
        
        function updateStatus(msg) {
            document.getElementById('status').textContent = msg;
            log('Status: ' + msg);
        }
        
        window.addEventListener('error', function(e) {
            const errorDiv = document.getElementById('errors');
            const errorMsg = 'ERROR: ' + e.message + ' (File: ' + e.filename + ', Line: ' + e.lineno + ')';
            errorDiv.innerHTML += '<div>' + errorMsg + '</div>';
            log(errorMsg);
        });
        
        updateStatus('Starting tests...');
    </script>
    
    <script src="/js/data-manager.js" 
            onload="log('‚úÖ data-manager.js loaded');"
            onerror="log('‚ùå data-manager.js FAILED');"></script>
    
    <script>
        setTimeout(async () => {
            try {
                updateStatus('Testing data manager...');
                
                if (typeof window.dataManager !== 'undefined') {
                    log('‚úÖ DataManager object exists');
                    
                    if (!window.dataManager.initialized) {
                        log('‚è≥ Initializing DataManager...');
                        await window.dataManager.init();
                    }
                    
                    if (window.dataManager.initialized) {
                        log('‚úÖ DataManager initialized successfully');
                        log('üìä Employees: ' + window.dataManager.employees.length);
                        log('üìã Attendance records: ' + window.dataManager.attendanceRecords.length);
                        
                        // Test stats
                        const stats = window.dataManager.getAttendanceStats();
                        log('üìà Today\'s stats: ' + JSON.stringify(stats, null, 2));
                        
                        updateStatus('‚úÖ All tests passed! Data manager is working.');
                    } else {
                        log('‚ùå DataManager failed to initialize');
                        updateStatus('‚ùå DataManager initialization failed');
                    }
                } else {
                    log('‚ùå DataManager object not found');
                    updateStatus('‚ùå DataManager not loaded');
                }
            } catch (error) {
                log('‚ùå Error during testing: ' + error.message);
                updateStatus('‚ùå Test failed: ' + error.message);
            }
        }, 1000);
    </script>
</body>
</html>
            onerror="updateStatus('theme.js FAILED');"></script>
    
    <script src="/js/modals.js" 
            onload="updateStatus('modals.js loaded');"
            onerror="updateStatus('modals.js FAILED');"></script>
    
    <script src="/js/charts.js" 
            onload="updateStatus('charts.js loaded');"
            onerror="updateStatus('charts.js FAILED');"></script>
            
    <script src="/js/dashboard-calendar.js" 
            onload="updateStatus('dashboard-calendar.js loaded');"
            onerror="updateStatus('dashboard-calendar.js FAILED');"></script>
    
    <script src="/js/sidebar.js" 
            onload="updateStatus('sidebar.js loaded');"
            onerror="updateStatus('sidebar.js FAILED');"></script>
    
    <script src="/js/dashboard.js" 
            onload="updateStatus('dashboard.js loaded');"
            onerror="updateStatus('dashboard.js FAILED');"></script>

    <script>
        setTimeout(() => {
            updateStatus('Testing complete. Check console for details.');
            
            console.log('Final status check:');
            console.log('ApexCharts:', typeof ApexCharts);
            console.log('mockData:', typeof mockData);
            console.log('dataService:', typeof dataService);
            console.log('authService:', typeof authService);
            console.log('SidebarManager:', typeof SidebarManager);
            console.log('DashboardController:', typeof DashboardController);
            console.log('chartsManager:', typeof chartsManager);
            
            // Try creating a simple ApexCharts chart
            if (typeof ApexCharts !== 'undefined') {
                try {
                    const options = {
                        chart: {
                            type: 'bar',
                            height: 200
                        },
                        series: [{
                            name: 'Test Data',
                            data: [44, 55, 57, 56, 61, 58, 63, 60, 66]
                        }],
                        xaxis: {
                            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep']
                        }
                    };
                    
                    const chart = new ApexCharts(document.querySelector("#testChart"), options);
                    chart.render();
                    updateStatus('ApexCharts test successful!');
                } catch (error) {
                    updateStatus('ApexCharts test failed: ' + error.message);
                    console.error('ApexCharts test error:', error);
                }
            } else {
                updateStatus('ApexCharts not available for testing');
            }
        }, 2000);
    </script>
</body>
</html>
