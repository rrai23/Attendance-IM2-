<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Debug Test</title>
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts" 
            onload="console.log('ApexCharts loaded:', typeof ApexCharts);"
            onerror="console.error('ApexCharts failed to load');"></script>
</head>
<body>
    <div style="padding: 20px;">
        <h1>Dashboard Debug Test</h1>
        <div id="status">Loading...</div>
        <div id="testChart" style="width: 400px; height: 200px; border: 1px solid #ccc; margin: 20px 0;"></div>
        
        <div id="errors" style="margin-top: 20px; color: red; font-family: monospace;"></div>
    </div>

    <!-- Load JavaScript files one by one -->
    <script>
        window.addEventListener('error', function(e) {
            const errorDiv = document.getElementById('errors');
            errorDiv.innerHTML += '<div>ERROR: ' + e.message + ' (File: ' + e.filename + ', Line: ' + e.lineno + ')</div>';
            console.error('Global error:', e);
        });
        
        function updateStatus(msg) {
            document.getElementById('status').textContent = msg;
            console.log('Status:', msg);
        }
        
        updateStatus('Starting tests...');
    </script>
    
    <script src="/js/mock-data.js" 
            onload="updateStatus('mock-data.js loaded');"
            onerror="updateStatus('mock-data.js FAILED');"></script>
    
    <script src="/js/data-service.js" 
            onload="updateStatus('data-service.js loaded');"
            onerror="updateStatus('data-service.js FAILED');"></script>
    
    <script src="/js/auth.js" 
            onload="updateStatus('auth.js loaded');"
            onerror="updateStatus('auth.js FAILED');"></script>
    
    <script src="/js/theme.js" 
            onload="updateStatus('theme.js loaded');"
            onerror="updateStatus('theme.js FAILED');"></script>
    
    <script src="/js/modals.js" 
            onload="updateStatus('modals.js loaded');"
            onerror="updateStatus('modals.js FAILED');"></script>
    
    <script src="/js/charts.js" 
            onload="updateStatus('charts.js loaded');"
            onerror="updateStatus('charts.js FAILED');"></script>
            
    <script src="/js/dashboard-calendar.js" 
            onload="updateStatus('dashboard-calendar.js loaded');"
            onerror="updateStatus('dashboard-calendar.js FAILED');"></script>
    
    <script src="/js/sidebar.js" 
            onload="updateStatus('sidebar.js loaded');"
            onerror="updateStatus('sidebar.js FAILED');"></script>
    
    <script src="/js/dashboard.js" 
            onload="updateStatus('dashboard.js loaded');"
            onerror="updateStatus('dashboard.js FAILED');"></script>

    <script>
        setTimeout(() => {
            updateStatus('Testing complete. Check console for details.');
            
            console.log('Final status check:');
            console.log('ApexCharts:', typeof ApexCharts);
            console.log('mockData:', typeof mockData);
            console.log('dataService:', typeof dataService);
            console.log('authService:', typeof authService);
            console.log('SidebarManager:', typeof SidebarManager);
            console.log('DashboardController:', typeof DashboardController);
            console.log('chartsManager:', typeof chartsManager);
            
            // Try creating a simple ApexCharts chart
            if (typeof ApexCharts !== 'undefined') {
                try {
                    const options = {
                        chart: {
                            type: 'bar',
                            height: 200
                        },
                        series: [{
                            name: 'Test Data',
                            data: [44, 55, 57, 56, 61, 58, 63, 60, 66]
                        }],
                        xaxis: {
                            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep']
                        }
                    };
                    
                    const chart = new ApexCharts(document.querySelector("#testChart"), options);
                    chart.render();
                    updateStatus('ApexCharts test successful!');
                } catch (error) {
                    updateStatus('ApexCharts test failed: ' + error.message);
                    console.error('ApexCharts test error:', error);
                }
            } else {
                updateStatus('ApexCharts not available for testing');
            }
        }, 2000);
    </script>
</body>
</html>
