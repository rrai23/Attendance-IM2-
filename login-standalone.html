<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Bricks Attendance System (Standalone)</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body class="page-login">
    <!-- Login Container -->
    <div class="login-container">
        <div class="login-card animate-slide-up">
            <!-- Theme Toggle for Login Page -->
            <div class="login-theme-toggle">
                <button class="theme-option active" data-theme="light" title="Light Mode">
                    <svg class="theme-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <button class="theme-option" data-theme="dark" title="Dark Mode">
                    <svg class="theme-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
            </div>

            <!-- Branding -->
            <div class="login-brand">
                <h1>Bricks Attendance</h1>
                <p>Employee Management System</p>
            </div>

            <!-- Login Form -->
            <form class="login-form" id="loginForm" novalidate>
                <div class="form-group">
                    <label for="username" class="form-label">Username</label>
                    <input 
                        type="text" 
                        id="username" 
                        name="username" 
                        class="form-input" 
                        placeholder="Enter your username"
                        required
                        autocomplete="username"
                        autofocus
                    >
                    <div class="form-error" id="usernameError"></div>
                </div>

                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <div class="password-input-container">
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            class="form-input" 
                            placeholder="Enter your password"
                            required
                            autocomplete="current-password"
                        >
                        <button 
                            type="button" 
                            class="password-toggle" 
                            id="passwordToggle"
                            aria-label="Toggle password visibility"
                            title="Show/hide password"
                        >
                            <span class="password-toggle-icon">üëÅÔ∏è</span>
                        </button>
                    </div>
                    <div class="form-error" id="passwordError"></div>
                </div>

                <div class="form-group">
                    <label class="checkbox-container">
                        <input type="checkbox" id="rememberMe" name="rememberMe">
                        <span class="checkbox-checkmark"></span>
                        <span class="checkbox-label">Remember me</span>
                    </label>
                </div>

                <!-- Login Button -->
                <button type="submit" class="btn btn-primary btn-lg" id="loginButton">
                    <span class="btn-text">Sign In</span>
                    <span class="btn-loading hidden">
                        <span class="loading-spinner"></span>
                        Signing in...
                    </span>
                </button>

                <!-- Error Alert -->
                <div class="alert alert-danger hidden" id="loginAlert" role="alert">
                    <span id="loginAlertMessage"></span>
                </div>
            </form>

            <!-- Login Footer -->
            <div class="login-footer">
                <p>Demo Credentials:</p>
                <div class="demo-credentials">
                    <div class="demo-credential">
                        <strong>Admin:</strong> admin / admin
                    </div>
                    <div class="demo-credential">
                        <strong>Employee:</strong> employee / employee
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Standalone login functionality that works without external dependencies
        console.log('Standalone login page loaded');
        
        class StandaloneLogin {
            constructor() {
                this.form = document.getElementById('loginForm');
                this.usernameInput = document.getElementById('username');
                this.passwordInput = document.getElementById('password');
                this.rememberMeCheckbox = document.getElementById('rememberMe');
                this.loginButton = document.getElementById('loginButton');
                this.loginAlert = document.getElementById('loginAlert');
                this.loginAlertMessage = document.getElementById('loginAlertMessage');
                this.passwordToggle = document.getElementById('passwordToggle');
                
                this.isLoading = false;
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.setupThemeToggle();
                this.setupPasswordToggle();
                this.setupDemoCredentials();
                this.applyStoredTheme();
                console.log('Standalone login initialized');
            }

            setupEventListeners() {
                this.form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleLogin();
                });

                this.usernameInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.passwordInput.focus();
                    }
                });

                this.passwordInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.handleLogin();
                    }
                });
            }

            setupThemeToggle() {
                const themeButtons = document.querySelectorAll('.theme-option');
                themeButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const theme = button.getAttribute('data-theme');
                        this.setTheme(theme);
                    });
                });
            }

            setupPasswordToggle() {
                this.passwordToggle.addEventListener('click', () => {
                    const isPassword = this.passwordInput.type === 'password';
                    this.passwordInput.type = isPassword ? 'text' : 'password';
                    
                    const icon = this.passwordToggle.querySelector('.password-toggle-icon');
                    icon.textContent = isPassword ? 'üôà' : 'üëÅÔ∏è';
                });
            }

            setupDemoCredentials() {
                document.querySelectorAll('.demo-credential').forEach(credential => {
                    credential.addEventListener('click', () => {
                        const text = credential.textContent;
                        if (text.includes('admin')) {
                            this.usernameInput.value = 'admin';
                            this.passwordInput.value = 'admin';
                        } else if (text.includes('employee')) {
                            this.usernameInput.value = 'employee';
                            this.passwordInput.value = 'employee';
                        }
                        this.usernameInput.focus();
                    });
                });
            }

            setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('brix-theme', theme);
                
                // Update button states
                document.querySelectorAll('.theme-option').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-theme') === theme) {
                        btn.classList.add('active');
                    }
                });
                
                console.log('Theme set to:', theme);
            }

            applyStoredTheme() {
                const storedTheme = localStorage.getItem('brix-theme') || 'light';
                this.setTheme(storedTheme);
            }

            async handleLogin() {
                if (this.isLoading) return;

                const username = this.usernameInput.value.trim();
                const password = this.passwordInput.value;

                if (!this.validateCredentials(username, password)) {
                    return;
                }

                this.setLoading(true);
                this.hideAlert();

                // Simulate loading delay
                await new Promise(resolve => setTimeout(resolve, 500));

                try {
                    const credentials = {
                        admin: { password: 'admin', role: 'admin', redirect: '/dashboard.html' },
                        employee: { password: 'employee', role: 'employee', redirect: '/employee.html' }
                    };

                    if (credentials[username] && credentials[username].password === password) {
                        // Store session data
                        const sessionData = {
                            username: username,
                            role: credentials[username].role,
                            loginTime: Date.now()
                        };
                        
                        localStorage.setItem('bricks_auth_user', JSON.stringify(sessionData));
                        localStorage.setItem('bricks_auth_session', 'standalone_token_' + Date.now());
                        localStorage.setItem('bricks_auth_expiry', (Date.now() + 8 * 60 * 60 * 1000).toString());

                        this.showSuccess('Login successful! Redirecting...');
                        
                        setTimeout(() => {
                            window.location.href = credentials[username].redirect;
                        }, 1000);
                    } else {
                        this.showError('Invalid username or password. Please try admin/admin or employee/employee.');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    this.showError('Login failed. Please try again.');
                } finally {
                    this.setLoading(false);
                }
            }

            validateCredentials(username, password) {
                if (!username) {
                    this.showError('Username is required');
                    return false;
                }
                if (!password) {
                    this.showError('Password is required');
                    return false;
                }
                return true;
            }

            showError(message) {
                this.loginAlertMessage.textContent = message;
                this.loginAlert.classList.remove('hidden', 'alert-success');
                this.loginAlert.classList.add('alert-danger');
            }

            showSuccess(message) {
                this.loginAlertMessage.textContent = message;
                this.loginAlert.classList.remove('hidden', 'alert-danger');
                this.loginAlert.classList.add('alert-success');
            }

            hideAlert() {
                this.loginAlert.classList.add('hidden');
            }

            setLoading(loading) {
                this.isLoading = loading;
                const btnText = this.loginButton.querySelector('.btn-text');
                const btnLoading = this.loginButton.querySelector('.btn-loading');

                if (loading) {
                    btnText.classList.add('hidden');
                    btnLoading.classList.remove('hidden');
                    this.loginButton.disabled = true;
                } else {
                    btnText.classList.remove('hidden');
                    btnLoading.classList.add('hidden');
                    this.loginButton.disabled = false;
                }
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            new StandaloneLogin();
        });

        // Add required styles
        const style = document.createElement('style');
        style.textContent = `
            .password-input-container {
                position: relative;
            }
            
            .password-toggle {
                position: absolute;
                right: 12px;
                top: 50%;
                transform: translateY(-50%);
                background: none;
                border: none;
                cursor: pointer;
                padding: 4px;
                border-radius: 4px;
                transition: background-color 0.15s;
            }
            
            .password-toggle:hover {
                background-color: var(--bg-tertiary);
            }
            
            .password-toggle-icon {
                font-size: 16px;
                opacity: 0.6;
            }
            
            .checkbox-container {
                display: flex;
                align-items: center;
                cursor: pointer;
                user-select: none;
            }
            
            .checkbox-container input[type="checkbox"] {
                display: none;
            }
            
            .checkbox-checkmark {
                width: 18px;
                height: 18px;
                border: 2px solid var(--border-color);
                border-radius: var(--radius-sm);
                margin-right: var(--spacing-sm);
                position: relative;
                transition: all 0.15s;
            }
            
            .checkbox-container input[type="checkbox"]:checked + .checkbox-checkmark {
                background-color: var(--accent-primary);
                border-color: var(--accent-primary);
            }
            
            .checkbox-container input[type="checkbox"]:checked + .checkbox-checkmark::after {
                content: '‚úì';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                color: white;
                font-size: 12px;
                font-weight: bold;
            }
            
            .checkbox-label {
                font-size: var(--font-size-sm);
                color: var(--text-secondary);
            }
            
            .demo-credentials {
                display: flex;
                flex-direction: column;
                gap: var(--spacing-xs);
                margin-top: var(--spacing-sm);
            }
            
            .demo-credential {
                font-size: var(--font-size-xs);
                color: var(--text-tertiary);
                padding: var(--spacing-xs) var(--spacing-sm);
                background-color: var(--bg-tertiary);
                border-radius: var(--radius-sm);
                cursor: pointer;
                transition: all 0.15s;
            }
            
            .demo-credential:hover {
                background-color: var(--accent-light);
                color: var(--accent-primary);
            }
            
            .loading-spinner {
                display: inline-block;
                width: 16px;
                height: 16px;
                border: 2px solid transparent;
                border-top: 2px solid currentColor;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-right: var(--spacing-sm);
            }
            
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
